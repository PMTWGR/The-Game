<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Music Industry Chess</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            display: grid;
            grid-template-columns: 300px 1fr 300px;
            grid-template-rows: auto 1fr auto;
            gap: 20px;
            max-width: 1800px;
            margin: 0 auto;
            min-height: 95vh;
        }

        .header {
            grid-column: 1 / -1;
            text-align: center;
            padding: 20px 0;
        }

        .header h1 {
            font-size: 3em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        /* Fixed panel styles */
        .panel {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            min-height: 400px;
            display: flex;
            flex-direction: column;
        }

        .panel h2 {
            font-size: 1.5em;
            margin-bottom: 15px;
            color: #4ecdc4;
            border-bottom: 2px solid #4ecdc4;
            padding-bottom: 5px;
        }

        /* Game board container */
        .game-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .board-container {
            position: relative;
            margin-bottom: 20px;
        }

        #chessboard {
            width: 560px;
            height: 560px;
            border: 3px solid #4ecdc4;
            border-radius: 5px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .controls {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        button {
            background: linear-gradient(45deg, #ff6b6b, #ff8e8e);
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
        }

        button:hover {
            transform: translateY(-2px);
        }

        /* Move list styling */
        .move-list {
            flex: 1;
            overflow-y: auto;
            max-height: 300px;
        }

        .move-item {
            padding: 8px;
            margin: 5px 0;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 5px;
            border-left: 3px solid #4ecdc4;
        }

        /* Legend styling */
        .legend-item {
            display: flex;
            align-items: center;
            margin: 10px 0;
            padding: 8px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 5px;
        }

        .legend-icon {
            width: 30px;
            height: 30px;
            margin-right: 10px;
            border-radius: 3px;
        }

        /* Educational content */
        .educational-content {
            flex: 1;
            overflow-y: auto;
        }

        .insight {
            background: rgba(78, 205, 196, 0.1);
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #4ecdc4;
        }

        .ai-thinking {
            background: rgba(255, 107, 107, 0.1);
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #ff6b6b;
        }

        /* Responsive design */
        @media (max-width: 1200px) {
            .container {
                grid-template-columns: 1fr;
                grid-template-rows: auto auto auto auto;
            }
            
            #chessboard {
                width: 400px;
                height: 400px;
            }
        }

        .square {
            transition: all 0.3s ease;
        }

        .square:hover {
            filter: brightness(1.2);
        }

        .selected {
            filter: brightness(1.3) !important;
            box-shadow: inset 0 0 10px rgba(78, 205, 196, 0.8);
        }

        .valid-move {
            position: relative;
        }

        .valid-move::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            background: rgba(78, 205, 196, 0.5);
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸŽµ Music Industry Chess</h1>
            <p>A Game of Strategy, Power, and Perspective</p>
        </div>

        <!-- Left Panel -->
        <div class="panel">
            <h2>MOVE LIST</h2>
            <div class="move-list" id="moveList">
                <!-- Moves will be added here -->
            </div>
            
            <div class="controls">
                <button onclick="resetGame()">New Game</button>
                <button onclick="undoMove()">Undo</button>
            </div>
        </div>

        <!-- Center Game Board -->
        <div class="game-container">
            <div class="board-container">
                <svg id="chessboard" width="560" height="560" viewBox="0 0 560 560">
                    <!-- Board squares -->
                    <pattern id="consumerPattern" patternUnits="userSpaceOnUse" width="70" height="70">
                        <rect width="70" height="70" fill="#2a2a4a"/>
                        <circle cx="35" cy="35" r="2" fill="#4ecdc4" opacity="0.3"/>
                    </pattern>
                    
                    <rect width="560" height="560" fill="url(#consumerPattern)"/>
                    
                    <!-- Chess squares overlay -->
                    <g id="boardSquares"></g>
                    
                    <!-- Pieces will be added here -->
                    <g id="pieces"></g>
                    
                    <!-- Valid move indicators -->
                    <g id="validMoves"></g>
                </svg>
            </div>
            
            <div class="controls">
                <button onclick="makeAIMove()">AI Move</button>
                <select id="aiPersonality">
                    <option value="orca">ORCA Independent</option>
                    <option value="major">Major Label</option>
                    <option value="tech">Tech Platform</option>
                </select>
            </div>
        </div>

        <!-- Right Panel -->
        <div class="panel">
            <h2>INDUSTRY INSIGHTS</h2>
            <div class="educational-content" id="educationalContent">
                <div class="insight">
                    <h3>ðŸŽ¯ The Board = Consumers</h3>
                    <p>Every square represents potential fans. The entire industry moves across consumer attention.</p>
                </div>
                <div class="ai-thinking" id="aiThinking">
                    <h3>ðŸ¤– AI Analysis</h3>
                    <p>Waiting for game to start...</p>
                </div>
            </div>
            
            <h2 style="margin-top: 20px;">LEGEND</h2>
            <div class="legend">
                <div class="legend-item">
                    <div class="legend-icon" style="background: #4ecdc4;"></div>
                    <span>King = Government</span>
                </div>
                <div class="legend-item">
                    <div class="legend-icon" style="background: #ff6b6b;"></div>
                    <span>Queen = Media</span>
                </div>
                <div class="legend-item">
                    <div class="legend-icon" style="background: #ffd166;"></div>
                    <span>Rook = Gatekeepers</span>
                </div>
                <div class="legend-item">
                    <div class="legend-icon" style="background: #06d6a0;"></div>
                    <span>Bishop = Awards</span>
                </div>
                <div class="legend-item">
                    <div class="legend-icon" style="background: #118ab2;"></div>
                    <span>Knight = Lawyers</span>
                </div>
                <div class="legend-item">
                    <div class="legend-icon" style="background: #ef476f;"></div>
                    <span>Pawn = Artists</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Game state
        const gameState = {
            board: [],
            currentPlayer: 'white',
            selectedPiece: null,
            validMoves: [],
            moveHistory: [],
            aiThinking: false
        };

        // Music Industry AI Personalities
        const aiPersonalities = {
            orca: {
                name: "ORCA Independent",
                style: "Patient developer focused on long-term artist growth",
                riskTolerance: 0.3,
                aggression: 0.4,
                priorities: ['artist_development', 'sustainability', 'community']
            },
            major: {
                name: "Major Label",
                style: "Aggressive consolidator focused on market control", 
                riskTolerance: 0.6,
                aggression: 0.8,
                priorities: ['market_share', 'quick_returns', 'control']
            },
            tech: {
                name: "Tech Platform", 
                style: "Innovative disruptor changing industry rules",
                riskTolerance: 0.7,
                aggression: 0.5,
                priorities: ['scale', 'data_control', 'innovation']
            }
        };

        // Piece values based on music industry impact
        const pieceValues = {
            'p': 1,   // Artist - foundational but low individual value
            'r': 5,   // Gatekeeper - controls access
            'n': 3,   // Lawyer - tactical specialist  
            'b': 3,   // Award - influences status
            'q': 9,   // Media - most powerful influencer
            'k': 1000 // Government - game-ending importance
        };

        // Initialize the game
        function initGame() {
            createBoard();
            setupPieces();
            drawBoard();
            updateEducationalContent("Welcome to Music Industry Chess! Make your first move as the creative side.");
        }

        // Create chess board squares
        function createBoard() {
            const boardSquares = document.getElementById('boardSquares');
            boardSquares.innerHTML = '';
            
            for (let row = 0; row < 8; row++) {
                gameState.board[row] = [];
                for (let col = 0; col < 8; col++) {
                    const isLight = (row + col) % 2 === 0;
                    const square = document.createElement('rect');
                    square.setAttribute('x', col * 70);
                    square.setAttribute('y', row * 70);
                    square.setAttribute('width', 70);
                    square.setAttribute('height', 70);
                    square.setAttribute('fill', isLight ? 'rgba(255,255,255,0.1)' : 'rgba(0,0,0,0.2)');
                    square.setAttribute('class', 'square');
                    square.addEventListener('click', () => handleSquareClick(row, col));
                    boardSquares.appendChild(square);
                    
                    gameState.board[row][col] = null;
                }
            }
        }

        // Set up initial piece positions
        function setupPieces() {
            // Black pieces (Industry side)
            setupRow(0, 'black', ['r', 'n', 'b', 'q', 'k', 'b', 'n', 'r']);
            setupRow(1, 'black', Array(8).fill('p'));
            
            // White pieces (Creative side)  
            setupRow(6, 'white', Array(8).fill('p'));
            setupRow(7, 'white', ['r', 'n', 'b', 'q', 'k', 'b', 'n', 'r']);
        }

        function setupRow(row, color, pieces) {
            for (let col = 0; col < 8; col++) {
                gameState.board[row][col] = color === 'white' ? pieces[col] : pieces[col].toUpperCase();
            }
        }

        // Draw pieces on board
        function drawBoard() {
            const piecesGroup = document.getElementById('pieces');
            piecesGroup.innerHTML = '';
            
            for (let row = 0; row < 8; row++) {
                for (let col = 0; col < 8; col++) {
                    const piece = gameState.board[row][col];
                    if (piece) {
                        drawPiece(piece, row, col);
                    }
                }
            }
        }

        // Draw individual piece
        function drawPiece(piece, row, col) {
            const isWhite = piece === piece.toLowerCase();
            const type = piece.toLowerCase();
            const color = isWhite ? 'white' : 'black';
            
            const group = document.createElement('g');
            group.setAttribute('class', `piece ${color}`);
            
            // Base circle
            const base = document.createElement('circle');
            base.setAttribute('cx', col * 70 + 35);
            base.setAttribute('cy', row * 70 + 35);
            base.setAttribute('r', 25);
            base.setAttribute('fill', getPieceColor(type, isWhite));
            base.setAttribute('stroke', isWhite ? '#4ecdc4' : '#ff6b6b');
            base.setAttribute('stroke-width', 2);
            
            // Piece symbol
            const text = document.createElement('text');
            text.setAttribute('x', col * 70 + 35);
            text.setAttribute('y', row * 70 + 42);
            text.setAttribute('text-anchor', 'middle');
            text.setAttribute('fill', 'white');
            text.setAttribute('font-weight', 'bold');
            text.setAttribute('font-size', '20');
            text.textContent = getPieceSymbol(type);
            
            group.appendChild(base);
            group.appendChild(text);
            document.getElementById('pieces').appendChild(group);
        }

        function getPieceColor(type, isWhite) {
            const colors = {
                'p': isWhite ? '#ef476f' : '#b91d47', // Artists
                'r': isWhite ? '#ffd166' : '#d4a017', // Gatekeepers  
                'n': isWhite ? '#118ab2' : '#0a5a78', // Lawyers
                'b': isWhite ? '#06d6a0' : '#049c76', // Awards
                'q': isWhite ? '#ff6b6b' : '#d42c2c', // Media
                'k': isWhite ? '#4ecdc4' : '#1a8c8c'  // Government
            };
            return colors[type];
        }

        function getPieceSymbol(type) {
            const symbols = {
                'p': 'â™ª', // Artist with microphone
                'r': 'â›©', // Gate
                'n': 'âš–', // Scales of justice
                'b': 'ðŸ†', // Trophy
                'q': 'ðŸ“¡', // Broadcasting
                'k': 'âš–'  // Gavel (government)
            };
            return symbols[type];
        }

        // Handle square clicks
        function handleSquareClick(row, col) {
            if (gameState.aiThinking) return;
            
            const piece = gameState.board[row][col];
            
            // If a piece is selected and clicked on valid move square
            if (gameState.selectedPiece) {
                const move = gameState.validMoves.find(m => m.toRow === row && m.toCol === col);
                if (move) {
                    makeMove(move);
                    return;
                }
            }
            
            // Select a piece
            if (piece && ((gameState.currentPlayer === 'white' && piece === piece.toLowerCase()) || 
                         (gameState.currentPlayer === 'black' && piece === piece.toUpperCase()))) {
                selectPiece(row, col);
            } else {
                clearSelection();
            }
        }

        // Select a piece and show valid moves
        function selectPiece(row, col) {
            clearSelection();
            
            gameState.selectedPiece = { row, col };
            gameState.validMoves = getValidMoves(row, col);
            
            // Visual feedback
            document.querySelectorAll('.square').forEach(square => {
                const x = parseInt(square.getAttribute('x')) / 70;
                const y = parseInt(square.getAttribute('y')) / 70;
                if (x === col && y === row) {
                    square.classList.add('selected');
                }
            });
            
            showValidMoves();
        }

        // Show valid moves visually
        function showValidMoves() {
            const validMovesGroup = document.getElementById('validMoves');
            validMovesGroup.innerHTML = '';
            
            gameState.validMoves.forEach(move => {
                const circle = document.createElement('circle');
                circle.setAttribute('cx', move.toCol * 70 + 35);
                circle.setAttribute('cy', move.toRow * 70 + 35);
                circle.setAttribute('r', 8);
                circle.setAttribute('fill', 'rgba(78, 205, 196, 0.6)');
                validMovesGroup.appendChild(circle);
            });
        }

        // Clear selection and valid moves
        function clearSelection() {
            gameState.selectedPiece = null;
            gameState.validMoves = [];
            
            document.querySelectorAll('.square').forEach(square => {
                square.classList.remove('selected');
            });
            
            document.getElementById('validMoves').innerHTML = '';
        }

        // Get valid moves for a piece (simplified rules)
        function getValidMoves(row, col) {
            const piece = gameState.board[row][col];
            const moves = [];
            const isWhite = piece === piece.toLowerCase();
            
            // Simplified movement rules for demo
            // In a full implementation, you'd have complete chess rules
            const directions = {
                'p': isWhite ? [[-1, 0], [-2, 0]] : [[1, 0], [2, 0]], // Pawns
                'r': [[-1,0],[1,0],[0,-1],[0,1]], // Rooks
                'n': [[-2,-1],[-2,1],[2,-1],[2,1],[-1,-2],[-1,2],[1,-2],[1,2]], // Knights
                'b': [[-1,-1],[-1,1],[1,-1],[1,1]], // Bishops
                'q': [[-1,0],[1,0],[0,-1],[0,1],[-1,-1],[-1,1],[1,-1],[1,1]], // Queens
                'k': [[-1,0],[1,0],[0,-1],[0,1],[-1,-1],[-1,1],[1,-1],[1,1]] // Kings
            };
            
            const type = piece.toLowerCase();
            const pieceDirs = directions[type];
            
            pieceDirs.forEach(([dRow, dCol]) => {
                let newRow = row + dRow;
                let newCol = col + dCol;
                
                if (newRow >= 0 && newRow < 8 && newCol >= 0 && newCol < 8) {
                    const target = gameState.board[newRow][newCol];
                    if (!target || (isWhite && target === target.toUpperCase()) || 
                        (!isWhite && target === target.toLowerCase())) {
                        moves.push({
                            fromRow: row,
                            fromCol: col,
                            toRow: newRow,
                            toCol: newCol,
                            piece: piece
                        });
                    }
                }
            });
            
            return moves;
        }

        // Make a move
        function makeMove(move) {
            const { fromRow, fromCol, toRow, toCol, piece } = move;
            
            // Update board
            gameState.board[toRow][toCol] = piece;
            gameState.board[fromRow][fromCol] = null;
            
            // Add to move history
            const moveNotation = `${String.fromCharCode(97 + fromCol)}${8 - fromRow}-${String.fromCharCode(97 + toCol)}${8 - toRow}`;
            gameState.moveHistory.push(moveNotation);
            
            // Update UI
            updateMoveList();
            drawBoard();
            clearSelection();
            
            // Switch player
            gameState.currentPlayer = gameState.currentPlayer === 'white' ? 'black' : 'white';
            
            // Add educational insight
            addEducationalInsight(move);
            
            // AI move if it's AI's turn
            if (gameState.currentPlayer === 'black') {
                setTimeout(() => makeAIMove(), 1000);
            }
        }

        // AI move logic
        function makeAIMove() {
            if (gameState.aiThinking) return;
            
            gameState.aiThinking = true;
            updateEducationalContent("ðŸ¤– AI is analyzing the industry landscape...");
            
            setTimeout(() => {
                const personality = aiPersonalities[document.getElementById('aiPersonality').value];
                const move = calculateAIMove(personality);
                
                if (move) {
                    makeMove(move);
                    addAIInsight(move, personality);
                }
                
                gameState.aiThinking = false;
            }, 1500);
        }

        // Calculate AI move based on personality
        function calculateAIMove(personality) {
            const possibleMoves = [];
            
            // Get all possible moves for black pieces
            for (let row = 0; row < 8; row++) {
                for (let col = 0; col < 8; col++) {
                    const piece = gameState.board[row][col];
                    if (piece && piece === piece.toUpperCase()) { // Black pieces
                        const moves = getValidMoves(row, col);
                        moves.forEach(move => {
                            // Evaluate move based on personality
                            const score = evaluateMove(move, personality);
                            possibleMoves.push({ move, score });
                        });
                    }
                }
            }
            
            if (possibleMoves.length === 0) return null;
            
            // Sort by score and pick based on risk tolerance
            possibleMoves.sort((a, b) => b.score - a.score);
            
            // Aggressive AI takes best move, cautious AI might mix it up
            const topMoves = possibleMoves.slice(0, Math.max(3, Math.floor(possibleMoves.length * personality.riskTolerance)));
            return topMoves[Math.floor(Math.random() * topMoves.length)].move;
        }

        // Evaluate a move based on AI personality
        function evaluateMove(move, personality) {
            let score = 0;
            const targetPiece = gameState.board[move.toRow][move.toCol];
            
            // Material value
            if (targetPiece) {
                const value = pieceValues[targetPiece.toLowerCase()];
                score += value * personality.aggression;
            }
            
            // Position bonuses based on personality
            if (personality.priorities.includes('control')) {
                // Prefer center control
                const centerDist = Math.abs(move.toRow - 3.5) + Math.abs(move.toCol - 3.5);
                score += (4 - centerDist) * 0.5;
            }
            
            if (personality.priorities.includes('artist_development')) {
                // Prefer developing pawns (artists)
                if (move.piece.toLowerCase() === 'p') {
                    score += 0.3;
                }
            }
            
            return score;
        }

        // Update move list display
        function updateMoveList() {
            const moveList = document.getElementById('moveList');
            moveList.innerHTML = '';
            
            gameState.moveHistory.forEach((move, index) => {
                const moveItem = document.createElement('div');
                moveItem.className = 'move-item';
                moveItem.textContent = `${index + 1}. ${move}`;
                moveList.appendChild(moveItem);
            });
            
            moveList.scrollTop = moveList.scrollHeight;
        }

        // Add educational insight for a move
        function addEducationalInsight(move) {
            const pieceType = move.piece.toLowerCase();
            const insights = {
                'p': `Artist advancing toward audience recognition. In 2023, 86.2% of songs received under 1,000 streams.`,
                'r': `Gatekeeper repositioning to control market access. Labels spend $3.9B annually on A&R.`,
                'n': `Legal maneuver creating new contractual pathways. Lawyers enable complex industry deals.`,
                'b': `Award influence shifting cultural status. Recognition can transform artist careers.`,
                'q': `Media outlet amplifying reach across markets. Narrative power shapes industry outcomes.`,
                'k': `Government ensuring regulatory stability. Policy changes affect all industry players.`
            };
            
            updateEducationalContent(insights[pieceType]);
        }

        // Add AI thinking insight
        function addAIInsight(move, personality) {
            const pieceType = move.piece.toLowerCase();
            const aiMessages = {
                orca: `ORCA Strategy: Patient artist development. Focusing on long-term ecosystem growth.`,
                major: `Major Label Approach: Aggressive market positioning. Seeking quick returns and control.`,
                tech: `Tech Platform Move: Innovative positioning. Changing the fundamental game dynamics.`
            };
            
            const thinkingElement = document.getElementById('aiThinking');
            thinkingElement.innerHTML = `
                <h3>ðŸ¤– ${personality.name} Analysis</h3>
                <p>${aiMessages[document.getElementById('aiPersonality').value]}</p>
                <p><em>${personality.style}</em></p>
            `;
        }

        // Update educational content
        function updateEducationalContent(message) {
            const content = document.getElementById('educationalContent');
            const insight = document.createElement('div');
            insight.className = 'insight';
            insight.innerHTML = `<p>${message}</p>`;
            
            // Keep only last 5 insights
            const insights = content.querySelectorAll('.insight');
            if (insights.length > 4) {
                insights[0].remove();
            }
            
            content.appendChild(insight);
            content.scrollTop = content.scrollHeight;
        }

        // Reset game
        function resetGame() {
            gameState.board = [];
            gameState.currentPlayer = 'white';
            gameState.selectedPiece = null;
            gameState.validMoves = [];
            gameState.moveHistory = [];
            gameState.aiThinking = false;
            
            initGame();
            updateEducationalContent("New game started! You're playing as the creative side (white pieces).");
            document.getElementById('aiThinking').innerHTML = `
                <h3>ðŸ¤– AI Analysis</h3>
                <p>Waiting for your move...</p>
            `;
        }

        // Undo last move
        function undoMove() {
            if (gameState.moveHistory.length > 0) {
                // Simple undo - in full implementation, you'd track game state history
                resetGame();
                updateEducationalContent("Game reset. The industry landscape has been restored.");
            }
        }

        // Initialize the game when page loads
        window.addEventListener('load', initGame);
    </script>
</body>
</html>
